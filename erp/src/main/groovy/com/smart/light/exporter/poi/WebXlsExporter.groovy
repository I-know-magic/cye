package com.smart.light.exporter.poiimport org.apache.commons.lang.StringUtilsimport javax.servlet.http.HttpServletRequestimport javax.servlet.http.HttpServletResponse/** * web Xlsx导出 * lvpeng */class WebXlsExporter extends XlsExporter{    /**     * 设置header     * @param response     * @param request     * @param filename     * @return     */     def setHeader(HttpServletResponse response,HttpServletRequest request, String filename) {        this.setFileDownloadHeader(request,response,filename)    }    /**     * 设置让浏览器弹出下载对话框的Header.     * @param fileName 下载后的文件名.     */    public static void setFileDownloadHeader(HttpServletRequest request, HttpServletResponse response, String fileName) {        final String userAgent = request.getHeader("USER-AGENT");        try {            //中文文件名支持            fileName = fileName + '.xls'            String finalFileName = URLEncoder.encode(fileName, "UTF-8")            if(StringUtils.contains(userAgent, "Firefox")){                finalFileName = new String(fileName.getBytes("UTF-8"), "ISO8859-1");            }// else if(StringUtils.contains(userAgent, "Mozilla")){//                finalFileName = new String(fileName.getBytes("UTF-8"), "ISO8859-1");//            }else{//                finalFileName = new String(fileName.getBytes("UTF-8"), "ISO8859-1");//            }            response.setHeader("Content-Disposition", "attachment; filename=${finalFileName};");            response.setHeader("Content-Type", "application/vnd.ms-excel")        } catch (UnsupportedEncodingException e) {            e.printStackTrace()        }    }}
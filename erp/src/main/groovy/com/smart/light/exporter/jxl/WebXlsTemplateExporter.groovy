package com.smart.light.exporter.jxlimport org.apache.commons.lang.StringUtilsimport javax.servlet.http.HttpServletRequestimport javax.servlet.http.HttpServletResponse/** * lvpeng on 2015/6/9. */class WebXlsTemplateExporter extends XlsTemplateExporter{    /**     * @param response     * @param request     * @param filename     * @return     */    def setHeader(HttpServletResponse response,HttpServletRequest request, String filename) {        this.setFileDownloadHeader(request,response,filename)    }    /**     * @param fileName     */    public static void setFileDownloadHeader(HttpServletRequest request, HttpServletResponse response, String fileName) {        final String userAgent = request.getHeader("USER-AGENT");        try {            fileName = fileName + '.xls'            String finalFileName = URLEncoder.encode(fileName, "UTF-8")            if(StringUtils.contains(userAgent, "Firefox")){                finalFileName = new String(fileName.getBytes("UTF-8"), "ISO8859-1");            }            response.setHeader("Content-Disposition", "attachment; filename=\"" + finalFileName + "\";");            response.setHeader("Content-Type", "application/vnd.ms-excel")        } catch (UnsupportedEncodingException e) {            e.printStackTrace()        }    }}
package com.smart.light.impimport groovy.transform.stc.ClosureParamsimport groovy.transform.stc.FromStringimport jxl.Sheetimport jxl.Workbookimport org.apache.commons.lang.StringUtilsimport org.apache.commons.lang.Validate/** * 导入excel包装类 * lvpeng */class WebXlsImporter<T> {    private InputStream inputStream    WebXlsImporter(InputStream inputStream){        this.inputStream = inputStream    }    List<T> getExcelToObject( @ClosureParams(value=FromString.class, options="jxl.Sheet,int")                                      Closure closure){        Validate.notNull(inputStream,'inputStream is null')        List<T> objects = []        try {            Workbook workbook = Workbook.getWorkbook(inputStream);            def sheets = workbook.getSheets()            sheets.each {                objects.addAll(closure.call(it,getRightRows(it)-1))            }        }catch (Exception e){            e.printStackTrace()        }        return objects    }    /**     * 计算EXCEL行数 删除空行     * @param sheet     * @return     */    static int getRightRows(Sheet sheet) {        int rsCols = sheet.getColumns(); // 列数        int rsRows = sheet.getRows(); // 行数        int nullCellNum;        int afterRows = rsRows;        for (int i = 1; i < rsRows; i++) { // 统计行中为空的单元格数            nullCellNum = 0;            for (int j = 0; j < rsCols; j++) {                String val = sheet.getCell(j, i).getContents();                val = StringUtils.trimToEmpty(val);                if (StringUtils.isBlank(val))                    nullCellNum++;            }            if (nullCellNum >= rsCols) { // 如果nullCellNum大于或等于总的列数                afterRows--; // 行数减一            }        }        return afterRows;    }}